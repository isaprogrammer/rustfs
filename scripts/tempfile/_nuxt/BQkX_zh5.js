import{e as ne,i as oe,k as ce,M as Te,r as v,A as re,x as Y,m as M,o as _,n as e,N as De,w as t,a as h,b as s,C as Z,d as p,t as o,c as I,_ as O,y as ae,I as de,F as le,B as ee,l as Ne,L as D,K as je,O as Me,P as Be,Q as Le,R as Je,S as Ye,U as He,V as Ze}from"./BvexhTZs.js";import B from"./B2MUHF3Z.js";import{u as me,a as Ge,_ as fe,b as _e,c as ye,d as ve,e as ge,f as be,g as he,h as we,i as xe,j as qe}from"./BuIOECtk.js";import{_ as Pe}from"./DJZ-4X_g.js";import{_ as We}from"./DLtCItMV.js";import{_ as Se}from"./C-3P3SYp.js";import{a as z,b as E,_ as R}from"./CX0wwNc8.js";import{_ as Ke}from"./QhSbJoSr.js";import{_ as se}from"./Te087XyE.js";import{M as Ie}from"./D6QIHz9A.js";import{u as Ve}from"./Bg3I8jjh.js";import{u as $e,D as Ue}from"./BQKrPI31.js";import{_ as Fe}from"./DlpFS5KH.js";import{u as ze,D as Ee,_ as Qe}from"./9WduX5_a.js";import{_ as ke}from"./zIRx1Luc.js";import{d as Xe}from"./CqtTy1rW.js";import{_ as es}from"./CdtAKlFY.js";import{m as pe}from"./BzVVdaTJ.js";import{_ as ss}from"./CjRf5-Eg.js";import{b as ts,_ as ls,a as Oe}from"./CyvZY9pv.js";import{_ as Ae}from"./CADlXJMh.js";import{_ as as}from"./BmVW1-Kl.js";import{D as ns}from"./Br9_p3OE.js";import"./DUVp9UZ0.js";import"./CUw6zPDB.js";import"./CNS46M7W.js";import"./DW7TBzO-.js";import"./BAYMBq5_.js";import"./CtKdyHjI.js";import"./D10rQJ_b.js";import"./DlAUqK2U.js";import"./DNxf501w.js";import"./DkygctF7.js";import"./CzQd9PUz.js";import"./6l0Pl64a.js";import"./k0-rRQS5.js";import"./CHIgUVhi.js";import"./Baq5sz8T.js";import"./CLsMh9cr.js";import"./aZk9Io0G.js";import"./CFMWe0vH.js";import"./BqQ6eC6R.js";import"./CIcvgKWt.js";import"./BaE5Zpvg.js";const os={class:"space-y-6"},cs={class:"grid gap-4 md:grid-cols-2"},rs={class:"truncate"},is={key:0,class:"flex flex-wrap gap-2"},us={class:"truncate"},ds={key:0,class:"ml-2 text-xs text-muted-foreground opacity-70"},ms={key:0,class:"flex flex-wrap gap-2"},ps={class:"flex justify-end gap-2"},fs=ne({__name:"new-form",emits:["search"],setup(q,{expose:g,emit:a}){const{t:m}=oe(),F=ce(),{createUser:w}=Ve(),{listPolicies:K,setUserOrGroupPolicy:x}=me(),{listGroup:f,updateGroupMembers:P,getGroup:r}=Ge(),{$api:G}=Te(),U=a,A=v(!1),b=v(!1),l=re({accessKey:"",secretKey:"",groups:[],policies:[],groupInheritedPolicies:[]}),u=re({accessKey:"",secretKey:""}),n=v([]),V=v([]),j=v(!1),$=v(!1),k=Y(()=>{const i=n.value.reduce((c,y)=>(c[y.value]=y.label,c),{});return l.groups.map(c=>i[c]??c)}),L=Y(()=>{const i=V.value.reduce((c,y)=>(c[y.value]=y.label,c),{});return l.policies.map(c=>i[c]??c)}),W=()=>{l.accessKey="",l.secretKey="",l.groups=[],l.policies=[],l.groupInheritedPolicies=[],u.accessKey="",u.secretKey="",j.value=!1,$.value=!1},J=async()=>{await Promise.all([ie(),T()]),A.value=!0},Q=()=>{A.value=!1,W()};g({openDialog:J});const te=()=>(u.accessKey="",u.secretKey="",l.accessKey.trim()?/^.{3,20}$/.test(l.accessKey)||(u.accessKey=m("username length cannot be less than 3 characters and greater than 20 characters")):u.accessKey=m("Please enter username"),l.secretKey.trim()?/^.{8,40}$/.test(l.secretKey)||(u.secretKey=m("password length cannot be less than 8 characters and greater than 40 characters")):u.secretKey=m("Please enter password"),!u.accessKey&&!u.secretKey),S=async()=>{if(!te()){F.error(m("Please fill in the correct format"));return}b.value=!0;try{await w({accessKey:l.accessKey,secretKey:l.secretKey,status:"enabled"}),l.policies.length&&await x({policyName:l.policies,userOrGroup:l.accessKey,isGroup:!1}),l.groups.length&&await Promise.all(l.groups.map(i=>P({group:i,members:[l.accessKey],isRemove:!1,groupStatus:"enabled"}))),F.success(m("Add Success")),U("search"),Q()}catch(i){console.error(i),F.error(m("Add Failed")),b.value=!1}},d=async i=>{try{const c=await r(i);return c.policy?c.policy.split(","):[]}catch(c){return console.error("获取分组策略失败:",c),[]}},N=async()=>{if(l.groupInheritedPolicies=[],l.groups.length>0){const i=l.groups.map(Ce=>d(Ce)),c=await Promise.all(i),y=Array.from(new Set(c.flat()));l.groupInheritedPolicies=y}C()},C=()=>{const i=Array.from(new Set([...l.policies,...l.groupInheritedPolicies]));l.policies=i},T=async()=>{const i=await K();V.value=Object.keys(i??{}).sort((c,y)=>c.localeCompare(y)).map(c=>({label:c,value:c}))},ie=async()=>{const i=await f();n.value=(i??[]).map(c=>({label:c,value:c}))},ue=async i=>{l.groups.includes(i)?l.groups=l.groups.filter(c=>c!==i):l.groups=[...l.groups,i],await N()},X=i=>{l.groupInheritedPolicies.includes(i)||(l.policies.includes(i)?l.policies=l.policies.filter(c=>c!==i):l.policies=[...l.policies,i])};return(i,c)=>(_(),M(Ie,{modelValue:e(A),"onUpdate:modelValue":c[4]||(c[4]=y=>De(A)?A.value=y:null),title:e(m)("Create User"),size:"lg","close-on-backdrop":!1},{footer:t(()=>[h("div",ps,[s(e(O),{variant:"outline",onClick:Q},{default:t(()=>[p(o(e(m)("Cancel")),1)]),_:1}),s(e(O),{variant:"default",loading:e(b),onClick:S},{default:t(()=>[p(o(e(m)("Submit")),1)]),_:1},8,["loading"])])]),default:t(()=>[h("div",os,[h("div",cs,[s(e(R),null,{default:t(()=>[s(e(z),null,{default:t(()=>[p(o(e(m)("User Name")),1)]),_:1}),s(e(E),null,{default:t(()=>[s(e(se),{modelValue:e(l).accessKey,"onUpdate:modelValue":c[0]||(c[0]=y=>e(l).accessKey=y),"default-value":"",minlength:"4",name:"new-user-access-key",spellcheck:"false",autocomplete:"new-user-access-key"},null,8,["modelValue"])]),_:1}),e(u).accessKey?(_(),M(e(Ke),{key:0,class:"text-destructive"},{default:t(()=>[p(o(e(u).accessKey),1)]),_:1})):Z("",!0)]),_:1}),s(e(R),null,{default:t(()=>[s(e(z),null,{default:t(()=>[p(o(e(m)("Password")),1)]),_:1}),s(e(E),null,{default:t(()=>[s(e(se),{modelValue:e(l).secretKey,"onUpdate:modelValue":c[1]||(c[1]=y=>e(l).secretKey=y),"default-value":"",minlength:"8",id:"new-user-password",spellcheck:"false",type:"password",name:"new-user-password",autocomplete:"new-user-password","aria-autocomplete":"none"},null,8,["modelValue"])]),_:1}),e(u).secretKey?(_(),M(e(Ke),{key:0,class:"text-destructive"},{default:t(()=>[p(o(e(u).secretKey),1)]),_:1})):Z("",!0)]),_:1})]),s(e(R),null,{default:t(()=>[s(e(z),null,{default:t(()=>[p(o(e(m)("Groups")),1)]),_:1}),s(e(E),null,{default:t(()=>[s(e(fe),{open:e(j),"onUpdate:open":c[2]||(c[2]=y=>De(j)?j.value=y:null)},{default:t(()=>[s(e(_e),{"as-child":""},{default:t(()=>[s(e(O),{type:"button",variant:"outline",class:"min-h-10 justify-between gap-2","aria-label":e(m)("Groups")},{default:t(()=>[h("span",rs,o(e(k).length?e(k).join(", "):e(m)("Select Group")),1),s(e(B),{class:"size-4 text-muted-foreground",name:"ri:arrow-down-s-line"})]),_:1},8,["aria-label"])]),_:1}),s(e(ye),{class:"w-72 p-0",align:"start"},{default:t(()=>[s(e(ve),null,{default:t(()=>[s(e(ge),{placeholder:e(m)("Search Group")},null,8,["placeholder"]),s(e(be),null,{default:t(()=>[s(e(he),null,{default:t(()=>[p(o(e(m)("No Data")),1)]),_:1}),s(e(we),null,{default:t(()=>[(_(!0),I(le,null,ae(e(n),y=>(_(),M(e(xe),{key:y.value,value:y.label,onSelect:()=>ue(y.value)},{default:t(()=>[s(e(B),{name:"ri:check-line",class:de(["mr-2 size-4",e(l).groups.includes(y.value)?"opacity-100":"opacity-0"])},null,8,["class"]),h("span",null,o(y.label),1)]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),e(l).groups.length?(_(),I("div",is,[(_(!0),I(le,null,ae(e(l).groups,y=>(_(),M(e(Se),{key:y,variant:"secondary"},{default:t(()=>[p(o(y),1)]),_:2},1024))),128))])):Z("",!0)]),_:1})]),_:1}),s(e(R),null,{default:t(()=>[s(e(z),null,{default:t(()=>[p(o(e(m)("Policy")),1)]),_:1}),s(e(E),null,{default:t(()=>[s(e(fe),{open:e($),"onUpdate:open":c[3]||(c[3]=y=>De($)?$.value=y:null)},{default:t(()=>[s(e(_e),{"as-child":""},{default:t(()=>[s(e(O),{type:"button",variant:"outline",class:"min-h-10 justify-between gap-2","aria-label":e(m)("Policy")},{default:t(()=>[h("span",us,o(e(L).length?e(L).join(", "):e(m)("Select user group policies")),1),s(e(B),{class:"size-4 text-muted-foreground",name:"ri:arrow-down-s-line"})]),_:1},8,["aria-label"])]),_:1}),s(e(ye),{class:"w-72 p-0",align:"start"},{default:t(()=>[s(e(ve),null,{default:t(()=>[s(e(ge),{placeholder:e(m)("Search Policy")},null,8,["placeholder"]),s(e(be),null,{default:t(()=>[s(e(he),null,{default:t(()=>[p(o(e(m)("No Data")),1)]),_:1}),s(e(we),null,{default:t(()=>[(_(!0),I(le,null,ae(e(V),y=>(_(),M(e(xe),{key:y.value,value:y.label,onSelect:()=>X(y.value),class:de({"opacity-70 cursor-not-allowed":e(l).groupInheritedPolicies.includes(y.value)}),disabled:e(l).groupInheritedPolicies.includes(y.value)},{default:t(()=>[s(e(B),{name:"ri:check-line",class:de(["mr-2 size-4",e(l).policies.includes(y.value)?"opacity-100":"opacity-0"])},null,8,["class"]),h("span",null,o(y.label),1),e(l).groupInheritedPolicies.includes(y.value)?(_(),I("span",ds,"("+o(e(m)("Inherited from group"))+")",1)):Z("",!0)]),_:2},1032,["value","onSelect","class","disabled"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"]),e(l).policies.length?(_(),I("div",ms,[(_(!0),I(le,null,ae(e(l).policies,y=>(_(),M(e(Se),{key:y,variant:"secondary"},{default:t(()=>[p(o(y),1)]),_:2},1024))),128))])):Z("",!0)]),_:1})]),_:1})])]),_:1},8,["modelValue","title"]))}}),_s=Object.assign(fs,{__name:"UserNewForm"}),ys={class:"space-y-4"},vs={key:0,class:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},gs={class:"w-full sm:max-w-xs"},bs={key:1,class:"flex flex-col gap-4 sm:flex-row sm:items-end sm:justify-between"},hs={class:"truncate"},ws={class:"flex items-center gap-2 sm:self-end"},xs={key:2,class:"flex flex-wrap gap-2"},Ss=ne({__name:"groups",props:{user:{}},emits:["search"],setup(q,{emit:g}){const{t:a}=oe(),{listGroup:m,updateGroupMembers:F}=Ge(),{getPolicyByUserName:w,setUserOrGroupPolicy:K}=me(),x=ce(),f=q,P=g,r=v(""),G=v(!1),U=v(!1),A=v([]),b=v([]),l=v(!1),u=Y(()=>f.user.memberOf??[]),n=Y(()=>u.value.map(S=>({name:S}))),V=[{id:"name",header:()=>a("Name"),cell:({row:S})=>D("span",{class:"font-medium"},S.original.name)}],{table:j}=$e({data:n,columns:V,getRowId:S=>S.name});ee(r,S=>{j.getColumn("name")?.setFilterValue(S||void 0)});const $=Y(()=>A.value.reduce((S,d)=>(S[d.value]=d.label,S),{})),k=Y(()=>b.value.map(S=>$.value[S]??S)),L=async()=>{try{const S=await m();A.value=(S??[]).map(d=>({label:d,value:d}))}catch{x.error(a("Failed to get data"))}};Ne(()=>{L(),b.value=[...u.value]}),ee(()=>f.user.memberOf,()=>{G.value||(b.value=[...u.value])},{immediate:!0});const W=()=>{b.value=[...u.value],U.value=!1,G.value=!0},J=()=>{b.value=[...u.value],U.value=!1,G.value=!1},Q=S=>{b.value.includes(S)?b.value=b.value.filter(d=>d!==S):b.value=[...b.value,S]},te=async()=>{if(f.user?.accessKey){l.value=!0;try{const S=new Set(u.value),d=new Set(b.value),N=Array.from(S).filter(X=>!d.has(X)),C=Array.from(d).filter(X=>!S.has(X));await Promise.all([...N.map(X=>F({group:X,members:[f.user.accessKey],isRemove:!0,groupStatus:"enabled"})),...C.map(X=>F({group:X,members:[f.user.accessKey],isRemove:!1,groupStatus:"enabled"}))]);const ie=(await w(f.user.accessKey))?.Statement?.map(X=>X.Origin?.policyName||X.Sid||"").filter(Boolean)||[],ue=Array.from(new Set(ie));await K({policyName:ue,userOrGroup:f.user.accessKey,isGroup:!1}),x.success(a("Update Success")),G.value=!1,U.value=!1,P("search")}catch{x.error(a("Update Failed"))}finally{l.value=!1}}};return(S,d)=>{const N=Pe;return _(),I("div",ys,[G.value?(_(),I("div",bs,[s(e(R),{class:"flex w-full flex-col gap-2"},{default:t(()=>[s(e(z),{class:"text-sm font-medium"},{default:t(()=>[p(o(e(a)("Select Group")),1)]),_:1}),s(e(E),{class:"space-y-2"},{default:t(()=>[s(e(fe),{open:U.value,"onUpdate:open":d[1]||(d[1]=C=>U.value=C)},{default:t(()=>[s(e(_e),{"as-child":""},{default:t(()=>[s(e(O),{type:"button",variant:"outline",class:"min-h-10 justify-between gap-2","aria-label":e(a)("Select Group")},{default:t(()=>[h("span",hs,o(k.value.length?k.value.join(", "):e(a)("Select Group")),1),s(e(B),{class:"size-4 text-muted-foreground",name:"ri:arrow-down-s-line"})]),_:1},8,["aria-label"])]),_:1}),s(e(ye),{class:"w-72 p-0",align:"start"},{default:t(()=>[s(e(ve),null,{default:t(()=>[s(e(ge),{placeholder:e(a)("Search Group")},null,8,["placeholder"]),s(e(be),null,{default:t(()=>[s(e(he),null,{default:t(()=>[p(o(e(a)("No Data")),1)]),_:1}),s(e(we),null,{default:t(()=>[(_(!0),I(le,null,ae(A.value,C=>(_(),M(e(xe),{key:C.value,value:C.label,onSelect:()=>Q(C.value)},{default:t(()=>[s(e(B),{name:"ri:check-line",class:de(["mr-2 size-4",b.value.includes(C.value)?"opacity-100":"opacity-0"])},null,8,["class"]),h("span",null,o(C.label),1)]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})]),_:1}),h("div",ws,[s(e(O),{variant:"ghost",onClick:J},{default:t(()=>[p(o(e(a)("Cancel")),1)]),_:1}),s(e(O),{variant:"outline",loading:l.value,onClick:te},{default:t(()=>[p(o(e(a)("Submit")),1)]),_:1},8,["loading"])])])):(_(),I("div",vs,[h("div",gs,[s(N,{modelValue:r.value,"onUpdate:modelValue":d[0]||(d[0]=C=>r.value=C),placeholder:e(a)("Search Group"),clearable:"",class:"max-w-xs"},null,8,["modelValue","placeholder"])]),s(e(O),{variant:"outline",class:"inline-flex items-center gap-2",onClick:W},{default:t(()=>[s(e(B),{class:"size-4",name:"ri:add-line"}),p(" "+o(e(a)("Edit Group")),1)]),_:1})])),b.value.length?(_(),I("div",xs,[(_(!0),I(le,null,ae(b.value,C=>(_(),M(e(Se),{key:C,variant:"secondary"},{default:t(()=>[p(o(C),1)]),_:2},1024))),128))])):Z("",!0),s(Ue,{table:e(j)},null,8,["table"])])}}}),Ks=Object.assign(Ss,{__name:"UserGroups"}),ks={class:"space-y-4"},Ps={key:0,class:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},Vs={class:"w-full sm:max-w-xs"},$s={key:1,class:"flex flex-col gap-4 sm:flex-row sm:items-end sm:justify-between"},Us={class:"truncate"},Cs={key:0,class:"ml-2 text-xs text-muted-foreground opacity-70 transition-opacity"},Ds={class:"flex items-center gap-2 sm:self-end"},Os={key:2,class:"flex flex-wrap gap-2"},As=ne({__name:"policies",props:{user:{}},emits:["search"],setup(q,{emit:g}){const{listPolicies:a,setUserOrGroupPolicy:m,getPolicyByUserName:F}=me();Ge();const{t:w}=oe(),K=ce(),x=v([]),f=async()=>{if(P.user?.accessKey)try{const d=await F(P.user.accessKey);if(d?.Statement){const N=new Set;d.Statement.forEach(C=>{(C.Origin?.type==="group"||C.Origin?.type==="both")&&C.Origin?.policyName&&N.add(C.Origin.policyName)}),x.value=Array.from(N)}}catch(d){console.error("Failed to load inherited policies:",d)}},P=q,r=g,G=v(""),U=v(!1),A=v(!1),b=v([]),l=v([]),u=v(!1),n=Y(()=>P.user.policy??[]),V=Y(()=>n.value.map(d=>({name:d}))),j=[{id:"name",header:()=>w("Name"),cell:({row:d})=>D("span",{class:"font-medium"},d.original.name)}],{table:$}=$e({data:V,columns:j,getRowId:d=>d.name});ee(G,d=>{$.getColumn("name")?.setFilterValue(d||void 0)});const k=Y(()=>b.value.reduce((d,N)=>(d[N.value]=N.label,d),{})),L=Y(()=>l.value.map(d=>k.value[d]??d)),W=async()=>{try{const d=await a();b.value=Object.keys(d??{}).sort((N,C)=>N.localeCompare(C)).map(N=>({label:N,value:N}))}catch{K.error(w("Failed to get data"))}};Ne(async()=>{await W(),l.value=[...n.value],await f()}),ee(()=>P.user.policy,()=>{U.value||(l.value=[...n.value])},{immediate:!0}),ee(U,async d=>{d&&await f()});const J=()=>{l.value=[...n.value],A.value=!1,U.value=!0},Q=()=>{l.value=[...n.value],A.value=!1,U.value=!1},te=d=>{if(l.value.includes(d)){if(x.value.includes(d))return;l.value=l.value.filter(N=>N!==d)}else l.value.includes(d)||(l.value=[...l.value,d])},S=async()=>{if(P.user?.accessKey){u.value=!0;try{await m({policyName:l.value,userOrGroup:P.user.accessKey,isGroup:!1}),K.success(w("Edit Success")),U.value=!1,A.value=!1,r("search")}catch{K.error(w("Edit Failed"))}finally{u.value=!1}}};return(d,N)=>{const C=Pe;return _(),I("div",ks,[U.value?(_(),I("div",$s,[s(e(R),{class:"flex w-full flex-col gap-2"},{default:t(()=>[s(e(z),{class:"text-sm font-medium"},{default:t(()=>[p(o(e(w)("Select Group")),1)]),_:1}),s(e(E),{class:"space-y-2"},{default:t(()=>[s(e(fe),{open:A.value,"onUpdate:open":N[1]||(N[1]=T=>A.value=T)},{default:t(()=>[s(e(_e),{"as-child":""},{default:t(()=>[s(e(O),{type:"button",variant:"outline",class:"min-h-10 justify-between gap-2","aria-label":e(w)("Select Group")},{default:t(()=>[h("span",Us,o(L.value.length?L.value.join(", "):e(w)("Select user group policies")),1),s(e(B),{class:"size-4 text-muted-foreground",name:"ri:arrow-down-s-line"})]),_:1},8,["aria-label"])]),_:1}),s(e(ye),{class:"w-72 p-0",align:"start"},{default:t(()=>[s(e(ve),null,{default:t(()=>[s(e(ge),{placeholder:e(w)("Search Policy")},null,8,["placeholder"]),s(e(be),null,{default:t(()=>[s(e(he),null,{default:t(()=>[p(o(e(w)("No Data")),1)]),_:1}),s(e(we),null,{default:t(()=>[(_(!0),I(le,null,ae(b.value,T=>(_(),M(e(xe),{key:T.value,value:T.label,onSelect:()=>te(T.value),disabled:x.value.includes(T.value)&&l.value.includes(T.value),class:"group"},{default:t(()=>[s(e(B),{name:"ri:check-line",class:de(["mr-2 size-4",l.value.includes(T.value)?"opacity-100":"opacity-0"])},null,8,["class"]),h("span",null,o(T.label),1),x.value.includes(T.value)?(_(),I("span",Cs,o(e(w)("(Inherited from group)")),1)):Z("",!0)]),_:2},1032,["value","onSelect","disabled"]))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})]),_:1}),h("div",Ds,[s(e(O),{variant:"ghost",onClick:Q},{default:t(()=>[p(o(e(w)("Cancel")),1)]),_:1}),s(e(O),{variant:"outline",loading:u.value,onClick:S},{default:t(()=>[p(o(e(w)("Submit")),1)]),_:1},8,["loading"])])])):(_(),I("div",Ps,[h("div",Vs,[s(C,{modelValue:G.value,"onUpdate:modelValue":N[0]||(N[0]=T=>G.value=T),placeholder:e(w)("Search Policy"),clearable:"",class:"max-w-xs"},null,8,["modelValue","placeholder"])]),s(e(O),{variant:"outline",class:"inline-flex items-center gap-2",onClick:J},{default:t(()=>[s(e(B),{class:"size-4",name:"ri:add-line"}),p(" "+o(e(w)("Edit Policy")),1)]),_:1})])),l.value.length?(_(),I("div",Os,[(_(!0),I(le,null,ae(l.value,T=>(_(),M(e(Se),{key:T,variant:"secondary"},{default:t(()=>[p(o(T),1)]),_:2},1024))),128))])):Z("",!0),s(Ue,{table:e($)},null,8,["table"])])}}}),Ns=Object.assign(As,{__name:"UserPolicies"}),Gs={class:"space-y-4"},Is={class:"grid gap-4 md:grid-cols-2"},js={class:"space-y-4"},Fs={class:"text-sm font-medium"},zs={class:"text-xs text-muted-foreground"},Es={class:"text-sm font-medium"},Rs={class:"text-xs text-muted-foreground"},Ts={class:"flex justify-end gap-2"},Ms=ne({__name:"access-key-edit-form",props:{user:{}},emits:["search"],setup(q,{emit:g}){const{t:a}=oe(),m=ce(),{updateServiceAccount:F}=ze(),{getPolicyByUserName:w}=me(),K=q,x=g,f=v(!1),P=v("{}"),r=re({accessKey:"",name:"",description:"",impliedPolicy:!0,expiry:null,policy:"",accountStatus:"on"}),G=Y({get:()=>r.accountStatus==="on",set:n=>{r.accountStatus=n?"on":"off"}}),U=Y(()=>new Date().toISOString()),A=async()=>{if(K.user?.parentUser)try{const n=await w(K.user.parentUser);P.value=JSON.stringify(n??{}),r.impliedPolicy&&(r.policy=P.value)}catch{P.value="{}"}};ee(()=>K.user,()=>{r.accessKey=K.user.accessKey??"",r.name=K.user.name??"",r.description=K.user.description??"",r.impliedPolicy=K.user.impliedPolicy??!0,r.expiry=K.user.expiration&&K.user.expiration!=="9999-01-01T00:00:00Z"?K.user.expiration:null,r.policy=K.user.policy??"{}",r.accountStatus=K.user.accountStatus??"on",A()},{immediate:!0,deep:!0}),ee(()=>r.impliedPolicy,n=>{n&&(r.policy=P.value)});const b=()=>{x("search")},l=()=>{if(!r.impliedPolicy)try{JSON.parse(r.policy||"{}")}catch{return m.error(a("Policy format invalid")),!1}return!0},u=async()=>{if(l()){f.value=!0;try{await F(K.user.accessKey,{newStatus:r.accountStatus,newName:r.name,newDescription:r.description,newPolicy:r.impliedPolicy?null:JSON.stringify(JSON.parse(r.policy||"{}")),newExpiration:r.expiry?new Date(r.expiry).toISOString():null}),m.success(a("Update Success")),x("search")}catch{m.error(a("Update Failed"))}finally{f.value=!1}}};return(n,V)=>{const j=Fe;return _(),I("div",Gs,[h("div",Is,[s(e(R),null,{default:t(()=>[s(e(z),null,{default:t(()=>[p(o(e(a)("Access Key")),1)]),_:1}),s(e(E),null,{default:t(()=>[s(e(se),{modelValue:r.accessKey,"onUpdate:modelValue":V[0]||(V[0]=$=>r.accessKey=$),disabled:""},null,8,["modelValue"])]),_:1})]),_:1}),s(e(R),null,{default:t(()=>[s(e(z),null,{default:t(()=>[p(o(e(a)("Expiration")),1)]),_:1}),s(e(E),null,{default:t(()=>[s(Ee,{modelValue:r.expiry,"onUpdate:modelValue":V[1]||(V[1]=$=>r.expiry=$),min:U.value,placeholder:e(a)("Please select expiration date")},null,8,["modelValue","min","placeholder"])]),_:1})]),_:1}),s(e(R),null,{default:t(()=>[s(e(z),null,{default:t(()=>[p(o(e(a)("Name")),1)]),_:1}),s(e(E),null,{default:t(()=>[s(e(se),{modelValue:r.name,"onUpdate:modelValue":V[2]||(V[2]=$=>r.name=$),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1}),s(e(R),null,{default:t(()=>[s(e(z),null,{default:t(()=>[p(o(e(a)("Description")),1)]),_:1}),s(e(E),null,{default:t(()=>[s(e(se),{modelValue:r.description,"onUpdate:modelValue":V[3]||(V[3]=$=>r.description=$),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1})]),h("div",js,[s(e(R),{orientation:"responsive",class:"items-start gap-3 rounded-md border p-3"},{default:t(()=>[s(e(z),{class:"space-y-1"},{default:t(()=>[h("p",Fs,o(e(a)("Use Main Account Policy")),1),h("p",zs,o(e(a)("Automatically inherit the main account policy when enabled.")),1)]),_:1}),s(e(E),{class:"flex justify-end"},{default:t(()=>[s(e(ke),{modelValue:r.impliedPolicy,"onUpdate:modelValue":V[4]||(V[4]=$=>r.impliedPolicy=$)},null,8,["modelValue"])]),_:1})]),_:1}),s(e(R),{orientation:"responsive",class:"items-start gap-3 rounded-md border p-3"},{default:t(()=>[s(e(z),{class:"space-y-1"},{default:t(()=>[h("p",Es,o(e(a)("Status")),1),h("p",Rs,o(r.accountStatus==="on"?e(a)("Available"):e(a)("Disabled")),1)]),_:1}),s(e(E),{class:"flex justify-end"},{default:t(()=>[s(e(ke),{modelValue:G.value,"onUpdate:modelValue":V[5]||(V[5]=$=>G.value=$)},null,8,["modelValue"])]),_:1})]),_:1})]),r.impliedPolicy?Z("",!0):(_(),M(e(R),{key:0},{default:t(()=>[s(e(z),null,{default:t(()=>[p(o(e(a)("Current User Policy")),1)]),_:1}),s(e(E),null,{default:t(()=>[s(j,{modelValue:r.policy,"onUpdate:modelValue":V[6]||(V[6]=$=>r.policy=$)},null,8,["modelValue"])]),_:1})]),_:1})),h("div",Ts,[s(e(O),{variant:"outline",onClick:b},{default:t(()=>[p(o(e(a)("Cancel")),1)]),_:1}),s(e(O),{variant:"default",loading:f.value,onClick:u},{default:t(()=>[p(o(e(a)("Submit")),1)]),_:1},8,["loading"])])])}}}),Bs=Object.assign(Ms,{__name:"UserAccessKeyEditForm"}),Ls={class:"space-y-4"},Js={key:0,class:"space-y-4"},Ys={class:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},Hs={class:"w-full sm:max-w-xs"},Zs={key:1,class:"space-y-4"},qs={class:"grid gap-4 md:grid-cols-2"},Ws={class:"text-sm font-medium"},Qs={class:"text-xs text-muted-foreground"},Xs={class:"flex justify-end gap-2"},et=ne({__name:"account",props:{user:{}},emits:["search","notice"],setup(q,{emit:g}){const{t:a}=oe(),m=ce(),F=je(),{listUserServiceAccounts:w,createServiceAccount:K,getServiceAccount:x,deleteServiceAccount:f}=ze(),{getPolicyByUserName:P}=me(),r=q,G=g,U=v(""),A=v([]),b=v(!1),l=v("add"),u=v(!1),n=re({accessKey:pe(20),secretKey:pe(40),name:"",description:"",impliedPolicy:!0,expiry:null,policy:"",accountStatus:"on"}),V=v({}),j=v(""),$=Y(()=>new Date().toISOString()),k=[{id:"accessKey",header:()=>a("Access Key"),cell:({row:i})=>D("span",{class:"text-center font-medium"},i.original.accessKey)},{id:"expiration",header:()=>a("Expiration"),cell:({row:i})=>D("span",{class:"text-center"},W(i.original.expiration))},{id:"status",header:()=>a("Status"),cell:({row:i})=>D("span",{class:"text-sm text-center"},i.original.accountStatus==="on"?a("Available"):a("Disabled"))},{id:"name",header:()=>a("Name"),cell:({row:i})=>D("span",{class:"text-center"},i.original.name||"-")},{id:"actions",header:()=>a("Actions"),enableSorting:!1,cell:({row:i})=>D("div",{class:"flex justify-center gap-2"},[D(O,{variant:"outline",size:"sm",class:"h-8 w-8 p-0",onClick:()=>d(i.original)},()=>D(B,{class:"size-4",name:"ri:edit-2-line"})),D(O,{variant:"outline",size:"sm",class:"h-8 w-8 p-0 text-destructive border-destructive",onClick:()=>ue(i.original)},()=>D(B,{class:"size-4",name:"ri:delete-bin-5-line"}))])}],{table:L}=$e({data:A,columns:k,getRowId:i=>i.accessKey});ee(U,i=>{L.getColumn("accessKey")?.setFilterValue(i||void 0)});const W=i=>{if(!i||i=="9999-01-01T00:00:00Z")return"-";const c=Xe(i);return c.isValid()?c.format("YYYY-MM-DD HH:mm"):"-"},J=()=>{n.accessKey=pe(20),n.secretKey=pe(40),n.name="",n.description="",n.impliedPolicy=!0,n.expiry=null,n.policy=j.value,n.accountStatus="on"},Q=async()=>{if(!r.user?.accessKey)return;const i=await w({user:r.user.accessKey});A.value=i?.accounts??[]},te=async()=>{if(!r.user?.accessKey)return;const i=await P(r.user.accessKey);j.value=JSON.stringify(i??{}),n.impliedPolicy&&(n.policy=j.value)};ee(()=>r.user.accessKey,()=>{Q(),te()},{immediate:!0}),ee(()=>n.impliedPolicy,i=>{i&&(n.policy=j.value)});const S=()=>{l.value="add",b.value=!0,J()},d=async i=>{l.value="edit",b.value=!0;const c=await x(i.accessKey);V.value={...c,accessKey:i.accessKey}},N=()=>{b.value=!1,u.value=!1,J(),Q()},C=()=>{b.value=!1,Q(),G("search")},T=()=>{if(!n.accessKey.trim())return m.error(a("Please enter Access Key")),!1;if(n.accessKey.length<3||n.accessKey.length>20)return m.error(a("Access Key length must be between 3 and 20 characters")),!1;if(!n.secretKey.trim())return m.error(a("Please enter Secret Key")),!1;if(n.secretKey.length<8||n.secretKey.length>40)return m.error(a("Secret Key length must be between 8 and 40 characters")),!1;if(!n.impliedPolicy)try{JSON.parse(n.policy||"{}")}catch{return m.error(a("Policy format invalid")),!1}return!0},ie=async()=>{if(l.value!=="edit"&&T()){u.value=!0;try{const i={...n,targetUser:r.user.accessKey,policy:n.impliedPolicy?null:JSON.stringify(JSON.parse(n.policy||"{}")),expiration:n.expiry?new Date(n.expiry).toISOString():"9999-01-01T00:00:00.000Z"},c=await K(i);m.success(a("Add Success")),N(),G("search"),G("notice",c),Q()}catch(i){console.error(i),m.error(a("Add Failed")),u.value=!1}}},ue=i=>{F.warning({title:a("Warning"),content:a("Confirm Delete"),positiveText:a("Confirm"),negativeText:a("Cancel"),onPositiveClick:()=>X(i)})},X=async i=>{try{await f(i.accessKey),m.success(a("Delete Success")),Q()}catch{m.error(a("Delete Failed"))}};return(i,c)=>{const y=Pe,Ce=Fe,Re=Bs;return _(),I("div",Ls,[b.value?l.value==="add"?(_(),I("div",Zs,[h("div",qs,[s(e(R),null,{default:t(()=>[s(e(z),null,{default:t(()=>[p(o(e(a)("Access Key")),1)]),_:1}),s(e(E),null,{default:t(()=>[s(e(se),{modelValue:n.accessKey,"onUpdate:modelValue":c[1]||(c[1]=H=>n.accessKey=H),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1}),s(e(R),null,{default:t(()=>[s(e(z),null,{default:t(()=>[p(o(e(a)("Secret Key")),1)]),_:1}),s(e(E),null,{default:t(()=>[s(e(se),{modelValue:n.secretKey,"onUpdate:modelValue":c[2]||(c[2]=H=>n.secretKey=H),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1}),s(e(R),null,{default:t(()=>[s(e(z),null,{default:t(()=>[p(o(e(a)("Expiration")),1)]),_:1}),s(e(E),null,{default:t(()=>[s(Ee,{modelValue:n.expiry,"onUpdate:modelValue":c[3]||(c[3]=H=>n.expiry=H),min:$.value,placeholder:e(a)("Please select expiration date")},null,8,["modelValue","min","placeholder"])]),_:1})]),_:1}),s(e(R),null,{default:t(()=>[s(e(z),null,{default:t(()=>[p(o(e(a)("Name")),1)]),_:1}),s(e(E),null,{default:t(()=>[s(e(se),{modelValue:n.name,"onUpdate:modelValue":c[4]||(c[4]=H=>n.name=H),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1}),s(e(R),{class:"md:col-span-2"},{default:t(()=>[s(e(z),null,{default:t(()=>[p(o(e(a)("Description")),1)]),_:1}),s(e(E),null,{default:t(()=>[s(e(es),{modelValue:n.description,"onUpdate:modelValue":c[5]||(c[5]=H=>n.description=H),rows:3},null,8,["modelValue"])]),_:1})]),_:1})]),s(e(R),{orientation:"responsive",class:"items-start rounded-md border px-3 py-2"},{default:t(()=>[s(e(z),{class:"space-y-1"},{default:t(()=>[h("p",Ws,o(e(a)("Use main account policy")),1),h("p",Qs,o(e(a)("Automatically inherit the main account policy when enabled.")),1)]),_:1}),s(e(E),{class:"flex justify-end"},{default:t(()=>[s(e(ke),{modelValue:n.impliedPolicy,"onUpdate:modelValue":c[6]||(c[6]=H=>n.impliedPolicy=H)},null,8,["modelValue"])]),_:1})]),_:1}),n.impliedPolicy?Z("",!0):(_(),M(e(R),{key:0},{default:t(()=>[s(e(z),null,{default:t(()=>[p(o(e(a)("Current User Policy")),1)]),_:1}),s(e(E),null,{default:t(()=>[s(Ce,{modelValue:n.policy,"onUpdate:modelValue":c[7]||(c[7]=H=>n.policy=H)},null,8,["modelValue"])]),_:1})]),_:1})),h("div",Xs,[s(e(O),{variant:"outline",onClick:N},{default:t(()=>[p(o(e(a)("Cancel")),1)]),_:1}),s(e(O),{variant:"default",loading:u.value,onClick:ie},{default:t(()=>[p(o(e(a)("Submit")),1)]),_:1},8,["loading"])])])):Z("",!0):(_(),I("div",Js,[h("div",Ys,[h("div",Hs,[s(y,{modelValue:U.value,"onUpdate:modelValue":c[0]||(c[0]=H=>U.value=H),placeholder:e(a)("Search Account"),clearable:"",class:"w-full"},null,8,["modelValue","placeholder"])]),s(e(O),{variant:"outline",class:"inline-flex items-center gap-2",onClick:S},{default:t(()=>[s(e(B),{class:"size-4",name:"ri:add-line"}),p(" "+o(e(a)("Add Account")),1)]),_:1})]),s(Ue,{table:e(L)},null,8,["table"])])),b.value&&l.value==="edit"?(_(),M(Re,{key:2,user:V.value,onSearch:C},null,8,["user"])):Z("",!0)])}}}),st=Object.assign(et,{__name:"UserAccount"}),tt={class:"space-y-4"},lt={class:"flex justify-end gap-2"},at=ne({__name:"change-secret-key",props:{visible:{type:Boolean},accessKey:{}},emits:["update:visible"],setup(q,{emit:g}){const{t:a}=oe(),{createUser:m}=Ve(),F=ce(),w=q,K=g,x=re({new_secret_key:"",re_new_secret_key:""}),f=re({new_secret_key:"",re_new_secret_key:""}),P=v(!1),r=Y({get(){return w.visible},set(l){U(l)}});function G(){x.new_secret_key="",x.re_new_secret_key="",Object.keys(f).forEach(l=>{f[l]=""})}function U(l=!1){K("update:visible",l),l||(G(),P.value=!1)}function A(){return f.new_secret_key=x.new_secret_key?"":a("Please enter new password"),x.re_new_secret_key?x.re_new_secret_key!==x.new_secret_key?f.re_new_secret_key=a("The two passwords are inconsistent"):f.re_new_secret_key="":f.re_new_secret_key=a("Please enter new password again"),!f.new_secret_key&&!f.re_new_secret_key}async function b(){if(!A()){F.error(a("Please fill in the correct format"));return}P.value=!0;try{await m({accessKey:w.accessKey,secretKey:x.new_secret_key,status:"enabled"}),F.success(a("Updated successfully")),U()}catch(l){console.error(l),F.error(a("Update failed"))}finally{P.value=!1}}return ee(()=>w.visible,l=>{l&&G()}),(l,u)=>(_(),M(Ie,{modelValue:r.value,"onUpdate:modelValue":u[3]||(u[3]=n=>r.value=n),title:e(a)("Change Secret Key")+(q.accessKey?`: ${q.accessKey}`:""),size:"md","close-on-backdrop":!1},{footer:t(()=>[h("div",lt,[s(e(O),{variant:"outline",onClick:u[2]||(u[2]=n=>U())},{default:t(()=>[p(o(e(a)("Cancel")),1)]),_:1}),s(e(O),{variant:"default",disabled:P.value,onClick:b},{default:t(()=>[P.value?(_(),M(e(ss),{key:0,class:"size-4"})):Z("",!0),h("span",null,o(e(a)("Submit")),1)]),_:1},8,["disabled"])])]),default:t(()=>[h("div",tt,[s(e(R),null,{default:t(()=>[s(e(z),{for:"secret-key-new"},{default:t(()=>[p(o(e(a)("New Secret Key")),1)]),_:1}),s(e(E),null,{default:t(()=>[s(e(se),{id:"secret-key-new",modelValue:x.new_secret_key,"onUpdate:modelValue":u[0]||(u[0]=n=>x.new_secret_key=n),type:"password",autocomplete:"off"},null,8,["modelValue"])]),_:1}),f.new_secret_key?(_(),M(e(Ke),{key:0,class:"text-destructive"},{default:t(()=>[p(o(f.new_secret_key),1)]),_:1})):Z("",!0)]),_:1}),s(e(R),null,{default:t(()=>[s(e(z),{for:"secret-key-confirm"},{default:t(()=>[p(o(e(a)("Confirm New Secret Key")),1)]),_:1}),s(e(E),null,{default:t(()=>[s(e(se),{id:"secret-key-confirm",modelValue:x.re_new_secret_key,"onUpdate:modelValue":u[1]||(u[1]=n=>x.re_new_secret_key=n),type:"password",autocomplete:"off",disabled:!x.new_secret_key},null,8,["modelValue","disabled"])]),_:1}),f.re_new_secret_key?(_(),M(e(Ke),{key:0,class:"text-destructive"},{default:t(()=>[p(o(f.re_new_secret_key),1)]),_:1})):Z("",!0)]),_:1})])]),_:1},8,["modelValue","title"]))}}),nt=Object.assign(at,{__name:"UserChangeSecretKey"}),ot={class:"space-y-4"},ct={class:"flex items-center justify-start gap-2 rounded-md border px-3 py-2"},rt={class:"text-sm text-muted-foreground"},it=ne({__name:"edit-form",setup(q,{expose:g}){const{t:a}=oe(),m=v(!1),F=v("groups"),w=v(!1),{getUser:K,changeUserStatus:x}=Ve(),f=v({accessKey:"",memberOf:[],policy:[],status:"enabled"}),P=Y({get:()=>f.value.status==="enabled",set:async l=>{const u=l?"enabled":"disabled";f.value.accessKey&&(await x(f.value.accessKey,{accessKey:f.value.accessKey,status:u}),await r())}}),r=async()=>{if(!f.value.accessKey)return;const l=await K(f.value.accessKey);f.value={accessKey:f.value.accessKey,memberOf:l.memberOf??[],policy:l.policyName?.split(",")??[],status:l.status??"enabled"}},G=v(),U=l=>{G.value?.openDialog(l)},A=()=>{m.value=!1,w.value=!0};async function b(l){f.value={accessKey:l.accessKey,memberOf:l.memberOf??[],policy:l.policy??[],status:l.status??"enabled"},F.value="groups",m.value=!0,await r()}return g({openDialog:b}),(l,u)=>{const n=B,V=O,j=Ks,$=Ns,k=st,L=Qe,W=nt;return _(),I(le,null,[s(Ie,{modelValue:m.value,"onUpdate:modelValue":u[2]||(u[2]=J=>m.value=J),title:f.value.accessKey||e(a)("Account"),size:"lg","close-on-backdrop":!1},{default:t(()=>[h("div",ot,[h("div",ct,[h("span",rt,o(e(a)("Status")),1),s(e(ke),{modelValue:P.value,"onUpdate:modelValue":u[0]||(u[0]=J=>P.value=J)},null,8,["modelValue"]),s(V,{variant:"outline",onClick:A,class:"ml-auto"},{default:t(()=>[s(n,{name:"ri:key-2-line",class:"size-4"}),h("span",null,o(e(a)("Change Secret Key")),1)]),_:1})]),s(e(ts),{modelValue:F.value,"onUpdate:modelValue":u[1]||(u[1]=J=>F.value=J),class:"flex flex-col gap-4"},{default:t(()=>[s(e(ls),{class:"w-full justify-start overflow-x-auto"},{default:t(()=>[s(e(Oe),{value:"groups"},{default:t(()=>[p(o(e(a)("Groups")),1)]),_:1}),s(e(Oe),{value:"policy"},{default:t(()=>[p(o(e(a)("Policies")),1)]),_:1}),s(e(Oe),{value:"account"},{default:t(()=>[p(o(e(a)("Account")),1)]),_:1})]),_:1}),s(e(Ae),{value:"groups",class:"mt-0"},{default:t(()=>[s(j,{user:f.value,onSearch:r},null,8,["user"])]),_:1}),s(e(Ae),{value:"policy",class:"mt-0"},{default:t(()=>[s($,{user:f.value,onSearch:r},null,8,["user"])]),_:1}),s(e(Ae),{value:"account",class:"mt-0"},{default:t(()=>[s(k,{user:f.value,onSearch:r,onNotice:U},null,8,["user"])]),_:1})]),_:1},8,["modelValue"]),s(L,{ref_key:"noticeRef",ref:G,onSearch:r},null,512)])]),_:1},8,["modelValue","title"]),s(W,{visible:w.value,"onUpdate:visible":u[3]||(u[3]=J=>w.value=J),"access-key":f.value.accessKey},null,8,["visible","access-key"])],64)}}}),ut=Object.assign(it,{__name:"UserEditForm"}),dt={class:"text-2xl font-bold"},mt={class:"space-y-4"},ll=ne({__name:"index",setup(q){const{t:g}=oe(),{listUsers:a,deleteUser:m}=Ve(),F=je(),w=ce(),K=v(""),x=v(!1),f=v([]),P=v(),r=v();async function G(k){try{await m(k.accessKey),w.success(g("Delete Success")),n.resetRowSelection(),await l()}catch{w.error(g("Delete Failed"))}}function U(k){r.value?.openDialog(k)}function A(){P.value?.openDialog()}const b=()=>{};async function l(){x.value=!0;try{const k=await a();f.value=Object.entries(k).map(([L,W])=>({accessKey:L,...typeof W=="object"?W:{}}))}catch{w.error(g("Failed to get data"))}finally{x.value=!1}n.resetRowSelection()}const u=[{accessorKey:"accessKey",header:()=>g("Name"),cell:({row:k})=>D("span",{class:"font-medium"},k.original.accessKey),filterFn:"includesString"},{id:"actions",header:()=>g("Actions"),enableSorting:!1,enableHiding:!1,meta:{width:200},cell:({row:k})=>D("div",{class:"flex items-center gap-2"},[D(O,{type:"button",size:"sm",variant:"outline",onClick:()=>U(k.original)},()=>[D(B,{class:"size-4",name:"ri:edit-2-line"}),D("span",g("Edit"))]),D(Me,{},{default:()=>[D(qe,{asChild:!0},{default:()=>D(O,{type:"button",size:"sm",variant:"outline"},()=>[D(B,{class:"size-4",name:"ri:delete-bin-5-line"}),D("span",g("Delete"))])}),D(Be,{},{default:()=>[D(Le,{},{default:()=>D(Je,{},()=>g("Confirm Delete"))}),D(Ye,{},{default:()=>[D(He,{},()=>g("Cancel")),D(Ze,{onClick:()=>G(k.original)},()=>g("Delete"))]})]})]})])}],{table:n,selectedRowIds:V}=$e({data:f,columns:u,getRowId:k=>k.accessKey,enableRowSelection:!0}),j=Y(()=>V.value);function $(){j.value.length&&F.error({title:g("Warning"),content:g("Are you sure you want to delete all selected users?"),positiveText:g("Confirm"),negativeText:g("Cancel"),onPositiveClick:async()=>{try{await Promise.all(j.value.map(k=>m(k))),w.success(g("Delete Success")),n.resetRowSelection(),await l()}catch{w.error(g("Delete Failed"))}}})}return ee(K,k=>{n.getColumn("accessKey")?.setFilterValue(k||void 0)}),Ne(()=>{l()}),(k,L)=>{const W=Pe,J=We,Q=_s,te=ut,S=as;return _(),M(S,null,{default:t(()=>[s(J,null,{actions:t(()=>[s(W,{modelValue:K.value,"onUpdate:modelValue":L[0]||(L[0]=d=>K.value=d),placeholder:e(g)("Search Access User"),clearable:"",class:"max-w-xs"},null,8,["modelValue","placeholder"]),s(e(O),{type:"button",variant:"outline",disabled:!j.value.length,onClick:$},{default:t(()=>[s(e(B),{class:"size-4",name:"ri:delete-bin-5-line"}),p(" "+o(e(g)("Delete Selected")),1)]),_:1},8,["disabled"]),s(e(O),{type:"button",variant:"outline",disabled:!j.value.length,onClick:b},{default:t(()=>[s(e(B),{class:"size-4",name:"ri:group-2-fill"}),p(" "+o(e(g)("Add to Group")),1)]),_:1},8,["disabled"]),s(e(O),{type:"button",variant:"outline",onClick:A},{default:t(()=>[s(e(B),{class:"size-4",name:"ri:add-line"}),p(" "+o(e(g)("Add User")),1)]),_:1})]),default:t(()=>[h("h1",dt,o(e(g)("Users")),1)]),_:1}),h("div",mt,[s(Ue,{table:e(n),"is-loading":x.value,"empty-title":e(g)("No Data"),"empty-description":e(g)("Create a user to get started"),"table-class":"min-w-full"},null,8,["table","is-loading","empty-title","empty-description"]),s(ns,{table:e(n)},null,8,["table"]),s(Q,{ref_key:"newItemRef",ref:P,onSearch:l},null,512),s(te,{ref_key:"editItemRef",ref:r,onSearch:l},null,512)])]),_:1})}}});export{ll as default};
